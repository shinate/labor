(()=>{var t={777:function(t){(function(){var e,a,n,r,o,i;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(t.exports=function(){return(e()-o)/1e6},a=process.hrtime,r=(e=function(){var t;return 1e9*(t=a())[0]+t[1]})(),i=1e9*process.uptime(),o=r-i):Date.now?(t.exports=function(){return Date.now()-n},n=Date.now()):(t.exports=function(){return(new Date).getTime()-n},n=(new Date).getTime())}).call(this)},38:(t,e,a)=>{for(var n=a(777),r="undefined"==typeof window?a.g:window,o=["moz","webkit"],i="AnimationFrame",c=r["request"+i],u=r["cancel"+i]||r["cancelRequest"+i],l=0;!c&&l<o.length;l++)c=r[o[l]+"Request"+i],u=r[o[l]+"Cancel"+i]||r[o[l]+"CancelRequest"+i];if(!c||!u){var s=0,h=0,d=[];c=function(t){if(0===d.length){var e=n(),a=Math.max(0,16.666666666666668-(e-s));s=a+e,setTimeout((function(){var t=d.slice(0);d.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(s)}catch(t){setTimeout((function(){throw t}),0)}}),Math.round(a))}return d.push({handle:++h,callback:t,cancelled:!1}),h},u=function(t){for(var e=0;e<d.length;e++)d[e].handle===t&&(d[e].cancelled=!0)}}t.exports=function(t){return c.call(r,t)},t.exports.cancel=function(){u.apply(r,arguments)},t.exports.polyfill=function(t){t||(t=r),t.requestAnimationFrame=c,t.cancelAnimationFrame=u}}},e={};function a(n){var r=e[n];if(void 0!==r)return r.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,a),o.exports}a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=a(38),e=a.n(t),n={getPixels:function(t){if(t instanceof ImageData)return t;if(t instanceof Image){var e,a;if(t.getContext){e=t;try{a=e.getContext("2d")}catch(t){}}a||(a=(e=this.getCanvas(t.width,t.height)).getContext("2d")).drawImage(t,0,0)}},getCanvas:function(t,e){var a=document.createElement("canvas");return a.width=t,a.height=e,a},applyFilter:function(t,e){for(var a=arguments.length,n=new Array(a>2?a-2:0),r=2;r<a;r++)n[r-2]=arguments[r];return t.apply(null,[].concat([this.getPixels(e)],n))},gray:function(t){for(var e=t.data,a=0;a<e.length;a+=4){var n=3*e[a]+4*e[a+1]+e[a+2]>>>3;e[a]=n,e[a+1]=n,e[a+2]=n}return t},grayscale:function(t,e){for(var a=t.data,n=0;n<a.length;n+=4){var r=.2126*a[n]+.7152*a[n+1]+.0722*a[n+2];a[n]=a[n+1]=a[n+2]=r}return t},brightness:function(t,e){for(var a=t.data,n=0;n<a.length;n+=4)a[n]+=e,a[n+1]+=e,a[n+2]+=e;return t},threshold:function(t,e){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[255,255,255],n=t.data,r=0;r<n.length;r+=4){var o=n[r],i=n[r+1],c=n[r+2];.2126*o+.7152*i+.0722*c>=e?(n[r]=a[0],n[r+1]=a[1],n[r+2]=a[2]):n[r]=n[r+1]=n[r+2]=0}return t}};n.tmpCanvas=document.createElement("canvas"),n.tmpCtx=n.tmpCanvas.getContext("2d"),n.createImageData=function(t,e){return this.tmpCtx.createImageData(t,e)},n.convolute=function(t,e,a){for(var r=Math.round(Math.sqrt(e.length)),o=Math.floor(r/2),i=t.data,c=t.width,u=t.height,l=c,s=u,h=n.createImageData(l,s),d=h.data,f=a?1:0,g=0;g<s;g++)for(var v=0;v<l;v++){for(var m=g,p=v,w=4*(g*l+v),x=0,y=0,M=0,b=0,D=0;D<r;D++)for(var I=0;I<r;I++){var C=4*(Math.min(u-1,Math.max(0,m+D-o))*c+Math.min(c-1,Math.max(0,p+I-o))),F=e[D*r+I];x+=i[C]*F,y+=i[C+1]*F,M+=i[C+2]*F,b+=i[C+3]*F}d[w]=x,d[w+1]=y,d[w+2]=M,d[w+3]=b+f*(255-b)}return h},window.Float32Array||(Float32Array=Array),n.convoluteFloat32=function(t,e,a){for(var n=Math.round(Math.sqrt(e.length)),r=Math.floor(n/2),o=t.data,i=t.width,c=t.height,u=i,l=c,s={width:u,height:l,data:new Float32Array(u*l*4)},h=s.data,d=a?1:0,f=0;f<l;f++)for(var g=0;g<u;g++){for(var v=f,m=g,p=4*(f*u+g),w=0,x=0,y=0,M=0,b=0;b<n;b++)for(var D=0;D<n;D++){var I=4*(Math.min(c-1,Math.max(0,v+b-r))*i+Math.min(i-1,Math.max(0,m+D-r))),C=e[b*n+D];w+=o[I]*C,x+=o[I+1]*C,y+=o[I+2]*C,M+=o[I+3]*C}h[p]=w,h[p+1]=x,h[p+2]=y,h[p+3]=M+d*(255-M)}return s};const r=n;var o={},i=document.querySelectorAll("canvas");o.source=document.querySelector("video"),o.dest=[i[0],i[1],i[2]],o.bg=document.createElement("canvas");var c,u,l,s,h,d=[o.dest[0].getContext("2d"),o.dest[1].getContext("2d"),o.dest[2].getContext("2d")],f=o.bg.getContext("2d"),g=function t(){var a,n,i,g;c/u<l/s?(a=c,g=0,i=(u-(n=s*(c/l)))/2):(n=u,g=(c-(a=l*(u/s)))/2,i=0),f.drawImage(o.source,g,i,a,n),h=f.getImageData(0,0,c,u),d[0].putImageData(function(t){t=r.grayscale(t);for(var e=r.convoluteFloat32(t,[-1,-2,-1,0,0,0,1,2,1]),a=r.convoluteFloat32(t,[-1,0,1,-2,0,2,-1,0,1]),n=r.createImageData(e.width,e.height),o=0;o<n.data.length;o+=4){var i=Math.abs(e.data[o]);n.data[o]=i;var c=Math.abs(a.data[o]);n.data[o+1]=c,n.data[o+2]=(i+c)/4,n.data[o+3]=255}return n}(h),0,0),d[1].putImageData(r.applyFilter(r.grayscale,h),0,0),d[2].putImageData(r.applyFilter(r.threshold,h,96,[16,128,16]),0,0),e()(t)},v=function(){c=o.source.clientWidth,u=o.source.clientHeight,o.bg.width=c,o.bg.height=u,o.dest.forEach((function(t){t.width=c,t.height=u}))};o.source.addEventListener("play",(function(){v(),g()}),!1),(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia).call(navigator,{video:!0},(function(t){var e=t.getVideoTracks()[0].getSettings();l=e.width,s=e.height,o.source.srcObject=t}),(function(t){t.PERMISSION_DENIED?alert("用户拒绝了浏览器请求媒体的权限"):t.NOT_SUPPORTED_ERROR?alert("constraint中指定的媒体类型不被支持"):t.MANDATORY_UNSATISFIED_ERROR&&alert("指定的媒体类型未接收到媒体流")})),window.onresize=function(){v()}})()})();